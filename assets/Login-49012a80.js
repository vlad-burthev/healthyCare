import{R as b,u as $,r as o,a as y,j as s,s as I,b as E,c as S,d as k,e as R,f as A,g as D}from"./index-fc83b678.js";import{M as d,C as B}from"./MyInput-a697f262.js";import{i as H}from"./logo_460x-343a9f33.js";function w(a=b){const n=a===b?$:()=>o.useContext(a);return function(){const{store:c}=n();return c}}const K=w();function O(a=b){const n=a===b?K:w(a);return function(){return n().dispatch}}const U=O(),T="_signPage_10w9w_1",p={signPage:T,"signPage-img":"_signPage-img_10w9w_12","signPage-content":"_signPage-content_10w9w_19","signPage-close":"_signPage-close_10w9w_30","signPage-close__login":"_signPage-close__login_10w9w_43","signPage-close__btn":"_signPage-close__btn_10w9w_46"},M="_login_16fkd_1",C={login:M,"login-btn":"_login-btn_16fkd_14","toogle-block":"_toogle-block_16fkd_29"},F=({signList:a})=>{const n=U(),[i,c]=o.useState("patients"),[f,v]=o.useState("Пацієнт"),u=y(),[t,r]=o.useState([]),[h,P]=o.useState("patients");o.useEffect(()=>{P(i)},[i]),o.useEffect(()=>{fetch(`http://localhost:3000/${h}`).then(l=>l.json()).then(l=>r(l))},[h]);const[g,j]=o.useState({login:"",pass:""}),[e,m]=o.useState();o.useEffect(()=>{const l=t.find(_=>_.login===g.login);l&&m(l.id)},[t,g.login]);const N=()=>{if(t.some(_=>_.login===g.login&&_.pass===g.pass?(m(_.id),!0):!1))switch(n(I(!0)),i){case"users":localStorage.setItem("myKey",1),n(D(!0)),u("/main/home");break;case"patients":localStorage.setItem("myKey",e),n(A(!0)),u(`/main/${h}/${e}`),n(S(e)),n(k("patients"));break;case"doctors":localStorage.setItem("myKey",e),n(R({doctor:!0,patientID:e})),u(`/main/${h}/${e}`),n(S({patientID:e})),n(k("doctors"));break;case"personal":localStorage.setItem("myKey",e),n(E({personal:!0,patientID:e})),u(`/main/${h}/${e}`),n(S(e)),n(k("personal"));break}else alert("Не вірний пароль або логін!")};return s.jsxs("div",{className:C.login,children:[s.jsxs("div",{children:[s.jsx("h1",{children:"Ви хочете увійти як :"}),s.jsx("div",{className:C["toogle-block"],children:a[0]&&Object.keys(a[0]).map(l=>s.jsx("button",{onClick:()=>{c(a[0][l].api),v(a[0][l].name)},style:{background:f===a[0][l].name?"rgb(156, 255, 159)":""},children:a[0][l].name},a[0][l].name))})]}),s.jsx("div",{children:s.jsx(d,{placeholder:"Введіть логін",onChange:l=>j({...g,login:l.target.value})})}),s.jsx("div",{children:s.jsx(d,{placeholder:"Введіть пароль",onChange:l=>j({...g,pass:l.target.value})})}),s.jsx("button",{className:C["login-btn"],onClick:N,children:"Авторизуватись"})]})},J="_reg_5kj8g_1",x={reg:J,"reg-btn":"_reg-btn_5kj8g_14","toogle-block":"_toogle-block_5kj8g_29","toogle-btn":"_toogle-btn_5kj8g_35"},q=({signList:a})=>{const[n,i]=o.useState("patients"),[c,f]=o.useState("patients");o.useEffect(()=>{f(n)},[n]);const[v,u]=o.useState("Пацієнт"),[t,r]=o.useState({login:"",pass:"",name:"",phone:"",email:"",age:"",gender:"",address:"",history:"",photo:"",disease:"",procedures:"",recordHistory:[],id:Date.now()}),[h,P]=o.useState([]);o.useEffect(()=>{fetch(`http://localhost:3000/${c}`).then(e=>e.json()).then(e=>P(e))},[c]);const g=h.find(e=>e.login===t.login&&e.email===t.email),j=()=>{const e={...t,login:t.login,pass:t.pass,name:t.name,phone:t.phone,email:t.email};if(t.login.length===0||t.pass.length===0||t.email.length===0||t.name.length===0||t.phone.length===0){alert("Усі поля повинні бути заповнені");return}g?alert("Такий логін або email вже зареєстрований"):(fetch(`http://localhost:3000/${c}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(m=>m.json()).catch(m=>console.log(m)),alert("Ви успішно зареєструвались"),r({...t,login:"",pass:"",name:"",phone:"",email:""}),location.reload())};return s.jsxs("div",{className:x.reg,children:[s.jsxs("div",{children:[s.jsx("h1",{children:"Ви хочете зареєструватися як :"}),s.jsx("div",{className:x["toogle-block"],children:a[0]&&Object.keys(a[0]).map(e=>s.jsx("button",{className:x["toogle-btn"],onClick:()=>{i(a[0][e].api),u(a[0][e].name)},style:{background:v===a[0][e].name?"rgb(156, 255, 159)":""},children:a[0][e].name},a[0][e].name))})]}),s.jsx("div",{children:s.jsx(d,{placeholder:"Введіть логін",value:t.login,onChange:e=>r({...t,login:e.target.value})})}),s.jsx("div",{children:s.jsx(d,{placeholder:"Введіть пароль",value:t.pass,onChange:e=>r({...t,pass:e.target.value})})}),s.jsx("div",{children:s.jsx(d,{placeholder:"Введіть ПІБ",value:t.name,onChange:e=>r({...t,name:e.target.value})})}),s.jsx("div",{children:s.jsx(d,{placeholder:"Введіть номер",value:t.phone,onChange:e=>r({...t,phone:e.target.value})})}),s.jsx("div",{children:s.jsx(d,{placeholder:"Введіть email",value:t.email,onChange:e=>r({...t,email:e.target.value})})}),s.jsx("button",{className:x["reg-btn"],onClick:j,children:"Зарееструватись"})]})},V=()=>{const a=[{patient:{api:"patients",name:"Пацієнт"},docotr:{api:"doctors",name:"Лікар"},personal:{api:"personal",name:"Мед. працівник"},users:{api:"users",name:"Реєстратор"}}],[n,i]=o.useState({state:!0,login:"Авторизуватись",reg:"Зареєструватись"});return s.jsxs("div",{className:p.signPage,children:[s.jsx("img",{src:H,alt:"",className:p["signPage-img"]}),s.jsx(B,{children:s.jsxs("div",{className:p["signPage-content"],children:[s.jsx("div",{className:`${p["signPage-close"]} ${n.state?p["signPage-close__login"]:""}`,children:s.jsx("button",{className:`${p["signPage-close__btn"]} `,onClick:()=>i({...n,state:!n.state}),children:n.state?n.reg:n.login})}),s.jsx(F,{signList:a}),s.jsx(q,{signList:a})]})})]})};export{V as default};
